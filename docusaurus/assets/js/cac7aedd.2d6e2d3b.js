"use strict";(self.webpackChunkkuzu_docs=self.webpackChunkkuzu_docs||[]).push([[3353],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>f});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),m=p(a),c=r,f=m["".concat(s,".").concat(c)]||m[c]||u[c]||l;return a?n.createElement(f,i(i({ref:t},d),{},{components:a})):n.createElement(f,i({ref:t},d))}));function f(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[m]="string"==typeof e?e:r,i[1]=o;for(var p=2;p<l;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},3847:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const l={title:"CSV"},i="Data Import from CSV Files",o={unversionedId:"data-import/csv-import",id:"data-import/csv-import",title:"CSV",description:"You can load the initial versions of your node and rel tables from CSV files",source:"@site/docs/data-import/csv-import.md",sourceDirName:"data-import",slug:"/data-import/csv-import",permalink:"/docusaurus/data-import/csv-import",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/data-import/csv-import.md",tags:[],version:"current",frontMatter:{title:"CSV"},sidebar:"tutorialSidebar",previous:{title:"Data Import",permalink:"/docusaurus/data-import/"},next:{title:"NPY",permalink:"/docusaurus/data-import/npy-import"}},s={},p=[{value:"Configuring CSV Reading",id:"configuring-csv-reading",level:2},{value:"Several Notes",id:"several-notes",level:2},{value:"<code>COPY FROM</code> a CSV File to a Node Table",id:"copy-from-a-csv-file-to-a-node-table",level:2},{value:"<code>COPY FROM</code> a CSV File to a Rel Table",id:"copy-from-a-csv-file-to-a-rel-table",level:2},{value:"<code>COPY FROM</code> Multiple CSV Files to a Single Table",id:"copy-from-multiple-csv-files-to-a-single-table",level:2}],d={toc:p},m="wrapper";function u(e){let{components:t,...a}=e;return(0,r.kt)(m,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"data-import-from-csv-files"},"Data Import from CSV Files"),(0,r.kt)("p",null,"You can load the initial versions of your node and rel tables from CSV files\nusing the ",(0,r.kt)("inlineCode",{parentName:"p"},"COPY FROM")," command. You should use CSV loading if you are ingesting large databases.\n",(0,r.kt)("inlineCode",{parentName:"p"},"COPY FROM")," commands can be used when your tables are completely empty. "),(0,r.kt)("h2",{id:"configuring-csv-reading"},"Configuring CSV Reading"),(0,r.kt)("p",null,"K\xf9zu's CSV reader has default configurations for a set of parameters for the CSV file, such as delimiters\nand escape character. These can be manually changed by specifying them inside ",(0,r.kt)("inlineCode",{parentName:"p"},"( )")," at the end of the\nthe ",(0,r.kt)("inlineCode",{parentName:"p"},"COPY FROM")," command. The following table specifies the parameters and their default values."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Default Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"HEADER"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Whether the first line of the CSV file is the header. Can be true or false."),(0,r.kt)("td",{parentName:"tr",align:"left"},"false")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"DELIM"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Character that separates different columns in a lines."),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},","))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"QUOTE"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Character to start a string quote."),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},'"'))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"ESCAPE"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Character within string quotes to escape QUOTE and other characters, e.g., a line break. ",(0,r.kt)("br",null)," See the important note below about line breaks lines below."),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"\\"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"LIST_BEGIN/LIST_END"),(0,r.kt)("td",{parentName:"tr",align:"left"},"For the ",(0,r.kt)("a",{parentName:"td",href:"/docusaurus/cypher/data-types/list"},"list data type"),", the delimiters to specify ",(0,r.kt)("br",null)," list begin and list end characters"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"["),", ",(0,r.kt)("inlineCode",{parentName:"td"},"]"))))),(0,r.kt)("p",null,"Here are examples of specifying that there is a header file and changing the delimiter from ",(0,r.kt)("inlineCode",{parentName:"p"},",")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"|"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'COPY User FROM "user.csv" (HEADER=true);\n\nCOPY User FROM "user.csv" (DELIM="|");\n')),(0,r.kt)("h2",{id:"several-notes"},"Several Notes"),(0,r.kt)("p",null,"Here are several important rules about K\xf9zu's CSV reader: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Starting with empty tables:")," ",(0,r.kt)("inlineCode",{parentName:"li"},"COPY FROM")," commands can be used when your tables are completely empty. So you should\nuse ",(0,r.kt)("inlineCode",{parentName:"li"},"COPY FROM")," immediately after you define the schemas of your tables. "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Copying Nodes Before Rels:")," In order to copy a rel table R from a csv file RFile, the nodes that appear RFile need to be\nalready in the database (either imported in bulk or inserted through Cypher data manipulation commands)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Line break/new line character (CRLF):"),' The line break character (one corresponding to the RETURN or Enter on most keyboards) can\nonly appear to start a new row in your CSVs. It cannot appear inside column values, e.g, inside a string column between "...CRLF...".\n',(0,r.kt)("inlineCode",{parentName:"li"},"COPY FROM")," commands will fail if this happens. You should instead use '\\n' character or '\\r\\n' to specify line breaks inside your strings."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Wrapping strings inside quotes:")," K\xf9zu will accept strings in string columns both with and without quotes. "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Leading and trailing spaces"),": As per the CSV standard, K\xf9zu does not ignore the leading and trailing spaces (e.g., if you input ",(0,r.kt)("inlineCode",{parentName:"li"}," 213")," for\nan integer value, that will be read as malformed integer and the corresponding node/rel property will be set to NULL."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Header line:")," Header lines, if they exist, are the first lines and ignored by the CSV reader. A header line can be added to your\nCSV files for your convenience but the CSV reader assumes a fixed order of columns (both for CSV files for nodes as well as relationship\ntables), so simply ignores the header row."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Extra columns in the csv files:")," K\xf9zu will omit any extra columns that don't match the table schema in the csv file.")),(0,r.kt)("h2",{id:"copy-from-a-csv-file-to-a-node-table"},(0,r.kt)("inlineCode",{parentName:"h2"},"COPY FROM")," a CSV File to a Node Table"),(0,r.kt)("p",null,"For the examples here, let us consider a ",(0,r.kt)("inlineCode",{parentName:"p"},"User(name STRING, age INT64, reg_date DATE, PRIMARY KEY (name))"),"\nnode table with the name, age, and reg_date predefined properties. The order of the columns need to\nmatch the order of the predefined properties for node tables in the catalog. This is the order you used\nwhen defining the schema of your node table. "),(0,r.kt)("p",null,"Example CSV file ",(0,r.kt)("inlineCode",{parentName:"p"},"user.csv")," without a header file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Adam,30,2020-06-22\nKarissa,40,2019-05-12\n...\n")),(0,r.kt)("p",null,"The same file with header could have the following first line if (HEADER = true) was given, which would however be ignored as explained above:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"name,age,reg_date\n")),(0,r.kt)("h2",{id:"copy-from-a-csv-file-to-a-rel-table"},(0,r.kt)("inlineCode",{parentName:"h2"},"COPY FROM")," a CSV File to a Rel Table"),(0,r.kt)("p",null,"The order of the columns are as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"FROM Node Column: The primary key of the FROM nodes."),(0,r.kt)("li",{parentName:"ul"},"TO Node Column: The primary key of the TO nodes."),(0,r.kt)("li",{parentName:"ul"},"Rest of the columns: The predefined properties on the relationship table as defined in your ",(0,r.kt)("inlineCode",{parentName:"li"},"CREATE REL TABLE")," command. ")),(0,r.kt)("p",null,"Here are a few examples:\nConsider the CREATE REL TABLE Follows(FROM User TO User, since DATE) table. An example CSV file ",(0,r.kt)("inlineCode",{parentName:"p"},"follows.csv")," without a header\ncan be as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Adam,Karissa,2010-01-30\nKarissa,Michelle,2014-01-30\n...\n")),(0,r.kt)("p",null,"You can use ",(0,r.kt)("inlineCode",{parentName:"p"},'COPY Follows FROM "follows.csv"')," to load this file."),(0,r.kt)("h2",{id:"copy-from-multiple-csv-files-to-a-single-table"},(0,r.kt)("inlineCode",{parentName:"h2"},"COPY FROM")," Multiple CSV Files to a Single Table"),(0,r.kt)("p",null,"It is a common practice to divide a voluminous CSV file into several smaller CSV files for the sake of convenience in storage. K\xf9zu can read multiple files of the same format (csv or parquet), and consolidating their data into a single node or relational table. User can load multiple files in the following ways:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Glob"),": Similar to Linux ",(0,r.kt)("a",{parentName:"li",href:"https://man7.org/linux/man-pages/man7/glob.7.html"},"Glob"),", K\xf9zu allows user to specify file paths that matches the glob pattern.")),(0,r.kt)("p",null,"Wildcard rules:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Wildcard"),(0,r.kt)("th",{parentName:"tr",align:null},"description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"*"),(0,r.kt)("td",{parentName:"tr",align:null},"match any number of any characters (including none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"?"),(0,r.kt)("td",{parentName:"tr",align:null},"match any single character")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"[abc]"),(0,r.kt)("td",{parentName:"tr",align:null},"match any one of the characters enclosed within the brackets")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"[a-z]"),(0,r.kt)("td",{parentName:"tr",align:null},"match any one of the characters within the range")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'COPY person FROM "vPerson*.csv"\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"List of files"),":")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'COPY person FROM ["vPerson0.csv", "vPerson1.csv", "vPerson2.csv"]\n')))}u.isMDXComponent=!0}}]);