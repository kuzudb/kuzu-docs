---
title: "Neo4j"
---

import { Tabs, TabItem } from '@astrojs/starlight/components';

The `Neo4j` extension allows users to efficiently migrate nodes and rels stored in neo4j to kuzu.

:::caution[Current status]
This is an experimental migration tool. Migrating multi-label nodes from neo4j to kuzu is currently not supported since kuzu doesn't support multi-label nodes.
If you encounter any issues while using this extension, please open a github issue or reach us on discord.
:::

## Example dataset:

Let's look at an example dataset to demonstrate how the neo4j extension can be used.
First, let's create two nodes and two rels in neo4j:

```cypher
CREATE (u:User {name: 'Adam', age: 30});
CREATE (u:User {name: 'Karissa', age: 40});
CREATE (u:User {name: 'Zhang', age: 50});
CREATE (u:User {name: 'Noura', age: 25});

CREATE (c:City {name: 'Waterloo', population: 150000});
CREATE (c:City {name: 'Kitchener', population: 200000});
CREATE (c:City {name: 'Guelph', population: 75000});

match (u:User {name: 'Adam'}), (c:City {name: 'Waterloo'}) create (u)-[:LivesIn]->(c);
match (u:User {name: 'Karissa'}), (c:City {name: 'Waterloo'}) create (u)-[:LivesIn]->(c);
match (u:User {name: 'Zhang'}), (c:City {name: 'Kitchener'}) create (u)-[:LivesIn]->(c);
match (u:User {name: 'Noura'}), (c:City {name: 'Guelph'}) create (u)-[:LivesIn]->(c);

match (u:User {name: 'Adam'}), (u1:User {name: 'Karissa'}) create (u)-[:Follows {since: 2020}]->(u1);
match (u:User {name: 'Adam'}), (u1:User {name: 'Zhang'}) create (u)-[:Follows {since: 2020}]->(u1);
match (u:User {name: 'Karissa'}), (u1:User {name: 'Zhang'}) create (u)-[:Follows {since: 2021}]->(u1);
match (u:User {name: 'Zhang'}), (u1:User {name: 'Noura'}) create (u)-[:Follows {since: 2022}]->(u1);
```
The above query creates `User`, `City` node labels and `LivesIn`, `Follows` rel labels.

## Installation
To get started with the neo4j extension, you need to first install and load the extension following the [Using Extensions in Kuzu](/extensions#using-extensions-in-kuzu) instructions.

```sql
INSTALL neo4j;
LOAD neo4j;
```

The neo4j migration tool relies on the `APOC`[https://neo4j.com/labs/apoc/] extension to export labels in neo4j. 
To ensure the neo4j migration tool work properly, `APOC` extension must be installed and the following configures must be properly added to the `apoc.conf` file in neo4j:
```sql
apoc.export.file.enabled=true
apoc.import.file.use_neo4j_config=false
```

In the following sections, we show how to migrate labels in neo4j to kuzu.
### Data Migration

Kuzu provides a function `NEO4J_MIGRATE` to migrate labels in neo4j to kuzu.

```cypher
CALL NEO4J_MIGRATE('HOST_NAME', 'USER_NAME', 'PASSWORD', ['NODE_LABEL1', 'NODE_LABEL2', 'NODE_LABEL2'...], ['REL_LABEL1', 'REL_LABEL2', 'REL_LABEL3'...])
```
- `HOST_NAME`: The url of NEO4J server.
- `USER_NAME`: NEO4J user name.
- `PASSWORD`: NEO4J password.
- `NODE_LABEL`: The node labels to migrate to kuzu. (Note: Migrating mutli-lable nodes is not supported)
- `REL_LABEL`: The rel labels to migrate to kuzu.

The example below shows how to migrate the `User`, `City`, `LivesIn` and `Follows` labels to kuzu:
```
CALL NEO4J_MIGRATE("HOST", "USER_NAME", "PASSWORD", ["User", "City"], ["Follows", "LivesIn"]);
```

To check tables that have been migrated to kuzu, users can utilize the `SHOW_TABLES()` call function:
```cypher:
CALL SHOW_TABLES()
RETURN *
```

Result:
```
┌────────┬─────────┬────────┬───────────────┬─────────┐
│ id     │ name    │ type   │ database name │ comment │
│ UINT64 │ STRING  │ STRING │ STRING        │ STRING  │
├────────┼─────────┼────────┼───────────────┼─────────┤
│ 0      │ User    │ NODE   │ local(kuzu)   │         │
│ 2      │ Follows │ REL    │ local(kuzu)   │         │
│ 1      │ City    │ NODE   │ local(kuzu)   │         │
│ 3      │ LivesIn │ REL    │ local(kuzu)   │         │
└────────┴─────────┴────────┴───────────────┴─────────┘
```

After data migration to kuzu, users can execute arbitrary cypher queries on those node/rel tables:
The query below asks for the user who latest follows another user.
```
match (u:User)-[f:Follows]->(u1:User) return max(f.since);
```

Result:
```
┌──────────────┐
│ MAX(f.since) │
│ INT64        │
├──────────────┤
│ 2022         │
└──────────────┘
```
